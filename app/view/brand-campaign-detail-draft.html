<form name="form" ng-cloak ng-model-options="{ debounce : { default : 300, blur : 0 }, allowInvalid: true}" novalidate>
    <div class="view-brand-detail-draft">
        <zone-header historyback="true">
        <h1 id="campaign-title" ng-bind="formData.title | truncate: 50"></h1>
        </zone-header>
        <div class="zone-body">
            <div class="container">
                <div nc-alert="alert"></div>
                <div nc-alert type="info" closable="false" ng-if="formData.status != 'Open'">
                    Influencer จะยังไม่เห็น Campaign นี้จนกว่าคุณจะลงประกาศ
                </div>
                <card-campaign-header campaign="formData" remove="remove()" removeable="formData.campaignId >= 0">
                </card-campaign-header>
                <div class="card-campaign-description" >
                    <div class="card-body">
                        <div class="card-row" form-error="form.title" is-validate="isPublishing()">
                            <div class="card-body-content-label with-input">
                                ชื่อ Campaign
                            </div>
                            <div class="card-body-content">
                                <input name="title" type="text" required ng-model="formData.title" class="form-control" maxlength="100">
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row" form-error="form.mainResource" is-validate="isPublishing($model, $error)">
                            <div class="card-body-content-label with-input">
                                รูป Campaign
                            </div>
                            <div class="card-body-content">
                                <uploader-thumb name="mainResource"
                                  ng-model="formData.mainResource"
                                  accept=".jpg,.png"
                                  ngf-pattern="'.jpg,.png'"
                                  ngf-max-size="5MB"
                                  aspect-ratio="1.5"
                                  required>
                                <i class="fa fa-camera"></i><br> เลือกรูป JPG หรือ PNG<br>อย่างน้อย 600 x 400 px
                                </uploader-thumb>
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row">
                            <div class="card-body-content-label with-checkbox">
                                ช่องทางการโปรโมท
                            </div>
                            <div class="card-body-content">
                                <div class="checkbox" ng-repeat="media in medium">
                                    <label>
                                        <input type="checkbox" ng-model="mediaBooleanDict[media.mediaId]">
                                        <span class="icon-{{media.mediaId}}"></span> {{media.mediaName}}
                                    </label>
                                </div>
                                <div class="has-error" ng-if="isInvalidMedia()">
                                    <div class="help-block">กรุณาเลือกอย่างน้อย 1 ช่องทาง</div>
                                </div>
                            </div>
                        </div>
                        <div class="card-row" form-error="form.category" is-validate="isPublishing()">
                            <div class="card-body-content-label with-input">
                                หมวดหมู่
                            </div>
                            <div class="card-body-content">
                                <div class="input-dropdown">
                                    <select name="category" class="form-control" ng-model="formData.category" ng-options="x as x.categoryName disable when x.categoryId == 0  for x in categories track by x.categoryId" ng-default="-- เลือกหมวดหมู่ --"
                                        required>
                                    </select>
                                    <i class="fa fa-caret-down"></i>
                                </div>
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row" form-error="form.description" is-validate="isPublishing()">
                            <div class="card-body-content-label with-input">
                                สิ่งที่อยากให้ทำ
                            </div>
                            <div class="card-body-content">
                                <textarea name="description" class="form-control" ng-model="formData.description" rows="4" maxlength="5000" required></textarea>
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row">
                            <div class="card-body-content-label with-input">
                                Keyword สำคัญ
                            </div>
                            <div class="card-body-content">
                                <input name="keyword" type="text" ng-model="formData.keyword" class="form-control" placeholder="Keyword ที่สำคัญแยกด้วยคอมม่า" maxlength="100">
                            </div>
                        </div>
                        <div class="card-row">
                            <div class="card-body-content-label with-input">
                                เว็บไซต์ของสินค้า
                            </div>
                            <div class="card-body-content">
                                <input type="text" class="form-control" ng-model="formData.website" maxlength="200" placeholder="ถ้ามี">
                            </div>
                        </div>
                        <div class="card-row" form-error="form.campaignResources">
                            <div class="card-body-content-label">
                                รูปประกอบ
                            </div>
                            <div class="card-body-content">
                                <uploader-multi name="resources"
                                  ng-model="formData.campaignResources"
                                  accept=".jpg,.png"
                                  ngf-pattern="'.jpg,.png'"
                                  ngf-max-size="5MB"
                                  ngf-max-files="20"></uploader-multi>
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row" form-error="form.budget" is-validate="isPublishing()">
                            <div class="card-body-content-label with-input">
                                ค่าตอบแทน
                            </div>
                            <div class="card-body-content">
                                <div class="input-dropdown">
                                    <select name="budget" class="form-control" ng-model="formData.budget"
                                    ng-options="x as budgetDisplayAs(x) disable when x.id == 0 for x in budgets track by x.budgetId" ng-default="-- เลือกค่าตอบแทน --" required>
                                    </select>
                                    <i class="fa fa-caret-down"></i>
                                </div>
                                <div input-error></div>
                            </div>
                        </div>
                        <div class="card-row" form-error="form.proposalDeadline" is-validate="isPublishing()">
                            <div class="card-body-content-label with-input">
                                รับข้อเสนอถึงถึง
                            </div>
                            <div class="card-body-content">
                                <p class="input-group">
                                  
                                    <input name="proposalDeadline" placeholder="-- เลือกวันปิดรับข้อเสนอ --" type="text" class="form-control" ng-focus="popup1_open = true"
                                          uib-datepicker-popup="{{$root.format}}" ng-model="formData.proposalDeadline" is-open="popup1_open" datepicker-options="dateOptions" show-button-bar="false" readonly
                                          close-text="Close" required/>

                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-default" ng-click="popup1_open = true"><i class="glyphicon glyphicon-calendar"></i></button>
                                    </span>
                                </p>
                                <div input-error></div>
                                <div class="info-text">
                                  ควรเปิดรับข้อเสนออย่างน้อย 2 สัปดาห์ เพื่อให้ได้ผลดีที่สุด
                                </div>
                            </div>
                        </div>


                        <div class="card-row" ng-if="!editOpenState">
                            <div class="card-button-primary">
                                <button class="btn-primary btn-width-max" ng-click="save(formData, mediaBooleanDict,mediaObjectDict, 'Open')">ลงประกาศ</button>
                                <br>
                                <div class="info-text">
                                    บันทึกและเปิดรับข้อเสนอ
                                </div>
                            </div>
                            <div class="card-button-secondary">
                                <button class="btn-secondary btn-width-max" ng-click="save(formData, mediaBooleanDict,mediaObjectDict, 'Draft')">บันทึกข้อมูล</button>
                                <br>
                                <div class="info-text">
                                    บันทึกเพื่อแก้ไขภายหลัง
                                </div>
                            </div>
                        </div>

                        <div class="card-row" ng-if="editOpenState">
                            <div class="card-button-primary">
                                <button class="btn-primary btn-width-max" ng-click="save(formData, mediaBooleanDict,mediaObjectDict, 'Open')">บันทึกการแก้ไข</button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</form>
